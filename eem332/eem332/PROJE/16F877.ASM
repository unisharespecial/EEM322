;PÝC ÝSMÝ;16F877(A)
;PÝC FREKANSI;4 MHZ
;DAHÝLÝ KOMUT CYCLE;1 MHZ
;SÝGORTA DURUMU;ON
;WATCHDOG TÝMER;OFF
;PROGRAM CALISMASI;
;ACIKLAMA;
;
;*********************************************************************** º
;*********************************************************************** º


	LIST	P=16F877
	INCLUDE	"P16F877.INC"

;*********************************
;*****DEFINE TANIMLAMA BLOGU******
;*********************************


;*********************************
;******MACRO TANIMLAMA BLOGU******
;*********************************

;*********************************
;******ADRES TANIMLAMA BLOGU******
;*********************************
CBLOCK	0x20
SAYAC_A
SAYAC_B
SAYAC_C
iNDEX
NEXTA1
NEXTA2
SAYAC1
SERiAL_DATA
SERiAL_DATA_COUNTER
ENDC
;*********************************
;*******GIRIS CIKIS BLOGU*********
;*********************************
	ORG	0x000
	CLRF	PORTA
	CLRF	PORTB
	CLRF	PORTC
	CLRF	PORTD
	CLRF	PORTE
	BANK1
	MOVLW	0x07
	MOVWF	ADCON1
	MOVLW	0xF8
	MOVWF	TRISA
	CLRF	TRISB
	CLRF	TRISC
	CLRF	TRISD
	CLRF	TRISE
	BANK0
	CLRF	PORTA
	CLRF	PORTB
	CLRF	PORTC
	CLRF	PORTD
	CLRF	PORTE
;*********************************
;*******ANA PROGRAM KISMI*********
;*********************************
	
START
	MOVLW	0xFF
	MOVWF	SAYAC_A
	MOVLW	0xFF
	MOVWF	SAYAC_B
	MOVLW	0xFF
	MOVWF	SAYAC_C
START1	
	CALL	TUS_TARA
	CALL	TIMER_KEYPAD
	GOTO	START1

;*********************************
;******* ALT PROG. KISMI**********
;*********************************

TUS_TARA
	
SATIR0
	MOVLW	0X01
	MOVWF	PORTA
A_BiR				;0.SATIR AKTÝF
	BTFSS	PORTA,3
	GOTO	A_iKi
	CALL	TIMER_KEYPAD
A_1
	BTFSC	PORTA,3
	GOTO	A_1
	CALL	TIMER_KEYPAD
	iNCF 	SAYAC_A,F
	MOVLW	0x0A
	XORWF	SAYAC_A,W
	BTFSC	STATUS,2
	CALL	SIFIRLA_A
	MOVF	SAYAC_A,W
	CALL	SERiAL_DATA_GONDER_1
	MOVLW	0x06
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_0
	RETURN
A_iKi
	BTFSS	PORTA,4
	GOTO	A_UC
	CALL	TIMER_KEYPAD
A_2
	BTFSC	PORTA,4
	GOTO	A_2
	CALL	TIMER_KEYPAD	
	iNCF 	SAYAC_A,F
	MOVLW	0x0A
	XORWF	SAYAC_A,W
	BTFSC	STATUS,2
	CALL	SIFIRLA_A
	MOVF	SAYAC_A,W
	ANDLW	0x0F
	CALL	DEC_TABLE
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_3
	MOVLW	0x06
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_2
	RETURN
A_UC
	BTFSS	PORTA,5
	GOTO	SATIR1
	CALL	TIMER_KEYPAD
A_3
	BTFSC	PORTA,5
	GOTO	A_3
	CALL	TIMER_KEYPAD
	iNCF 	SAYAC_A,F
	MOVLW	0x0A
	XORWF	SAYAC_A,W
	BTFSC	STATUS,2
	CALL	SIFIRLA_A
	MOVF	SAYAC_A,W
	ANDLW	0x0F
	CALL	DEC_TABLE
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_5
	MOVLW	0x06
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_4
	RETURN
SATIR1
	MOVLW	0X02
	MOVWF	PORTA
B_BiR				;1.SATIR AKTÝF
	BTFSS	PORTA,3
	GOTO	B_iKi
	CALL	TIMER_KEYPAD
B_1
	BTFSC	PORTA,3
	GOTO	B_1
	CALL	TIMER_KEYPAD
	MOVLW	0x0A
	XORWF	SAYAC_B,W
	BTFSC	STATUS,2
	CALL	SIFIRLA_B
	MOVF	SAYAC_B,W
	ANDLW	0x0F
	CALL	DEC_TABLE
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_1
	MOVLW	0x5B
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_0
	RETURN
B_iKi
	BTFSS	PORTA,4
	GOTO	B_UC
	CALL	TIMER_KEYPAD
B_2
	BTFSC	PORTA,4
	GOTO	B_2
	CALL	TIMER_KEYPAD
	iNCF 	SAYAC_B,F
	MOVLW	0x0A
	XORWF	SAYAC_B,W
	BTFSC	STATUS,2
	CALL	SIFIRLA_B
	MOVF	SAYAC_B,W
	ANDLW	0x0F
	CALL	DEC_TABLE
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_3
	MOVLW	0x5B
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_2
	RETURN
B_UC
	BTFSS	PORTA,5
	GOTO	SATIR2
	CALL	TIMER_KEYPAD
B_3
	BTFSC	PORTA,5
	GOTO	B_3
	CALL	TIMER_KEYPAD
	iNCF 	SAYAC_B,F
	MOVLW	0x0A
	XORWF	SAYAC_B,W
	BTFSC	STATUS,2
	CALL	SIFIRLA_B
	MOVF	SAYAC_B,W
	ANDLW	0x0F
	CALL	DEC_TABLE
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_5
	MOVLW	0x5B
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_4
	RETURN
SATIR2
	MOVLW	0X04
	MOVWF	PORTA
C_BiR				;2.SATIR AKTÝF
	BTFSS	PORTA,3
	GOTO	C_iKi
	CALL	TIMER_KEYPAD
C_1
	GOTO	C_1
	CALL	TIMER_KEYPAD
	iNCF 	SAYAC_C,F
	MOVLW	0x0A
	XORWF	SAYAC_C,W
	BTFSC	STATUS,2
	CALL	SIFIRLA_C
	MOVF	SAYAC_C,W
	ANDLW	0x0F
	CALL	DEC_TABLE
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_1
	MOVLW	0x4F
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_0
	RETURN
C_iKi
	BTFSS	PORTA,4
	GOTO	C_UC
	CALL	TIMER_KEYPAD
C_2
	BTFSC	PORTA,4
	GOTO	C_2
	CALL	TIMER_KEYPAD
	iNCF 	SAYAC_C,F
	MOVLW	0x0A
	XORWF	SAYAC_C,W
	BTFSC	STATUS,2
	CALL	SIFIRLA_C
	MOVF	SAYAC_C,W
	ANDLW	0x0F
	CALL	DEC_TABLE
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_3
	MOVLW	0x4F
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_2
	RETURN
C_UC
	BTFSS	PORTA,5
	GOTO	TUS_TARA
	CALL	TIMER_KEYPAD
C_3
	BTFSC	PORTA,5
	GOTO	C_3
	CALL	TIMER_KEYPAD
	iNCF 	SAYAC_C,F
	MOVLW	0x0A
	XORWF	SAYAC_C,W
	BTFSC	STATUS,2
	CALL	SIFIRLA_C
	MOVF	SAYAC_C,W
	ANDLW	0x0F
	CALL	DEC_TABLE
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_5
	MOVLW	0x4F
	MOVWF	SERiAL_DATA
	CALL	SERiAL_DATA_GONDER_4
	RETURN
DEC_TABLE
	ADDWF	PCL,F
	RETLW	0x3F
	RETLW	0x06
	RETLW	0x5B
	RETLW	0x4F
	RETLW	0x66
	RETLW	0x6D
	RETLW	0x7D
	RETLW	0x07
	RETLW	0x7F
	RETLW	0x6F

SERiAL_DATA_GONDER_0
	MOVLW	0x08
	MOVWF	SERiAL_DATA_COUNTER
SERiAL_DATA_0
	RLF	SERiAL_DATA,F
	BTFSS	STATUS,C
	GOTO	D0_0
	DATA_1			;DATA
	GOTO	D0_1
D0_0
	DATA_0			;DATA
D0_1
	CLOCK_1			;CLOCK
	CALL	TIMER_SERiAL
	CLOCK_0			;CLOCK
	DECFSZ	SERiAL_DATA_COUNTER,F
	GOTO	SERiAL_DATA_0
	LATC0_1
	CALL	TIMER_SERiAL
	LATC0_0
	RETURN

SERiAL_DATA_GONDER_1
	MOVLW	0x08
	MOVWF	SERiAL_DATA_COUNTER
SERiAL_DATA_1
	RLF	SERiAL_DATA,F
	BTFSS	STATUS,C
	GOTO	D1_0
	DATA_1			;DATA
	GOTO	D1_1
D1_0
	DATA_0			;DATA
D1_1
	CLOCK_1			;CLOCK
	CALL	TIMER_SERiAL
	CLOCK_0			;CLOCK
	DECFSZ	SERiAL_DATA_COUNTER,F
	GOTO	SERiAL_DATA_1
	LATC1_1
	CALL	TIMER_SERiAL
	LATC1_0
	RETURN
SERiAL_DATA_GONDER_2
	MOVLW	0x08
	MOVWF	SERiAL_DATA_COUNTER
SERiAL_DATA_2
	RLF	SERiAL_DATA,F
	BTFSS	STATUS,C
	GOTO	D2_0
	DATA_1			;DATA
	GOTO	D2_1
D2_0
	DATA_0			;DATA
D2_1
	CLOCK_1			;CLOCK
	CALL	TIMER_SERiAL
	CLOCK_0			;CLOCK
	DECFSZ	SERiAL_DATA_COUNTER,F
	GOTO	SERiAL_DATA_2
	LATC2_1
	CALL	TIMER_SERiAL
	LATC2_0
	RETURN

SERiAL_DATA_GONDER_3
	MOVLW	0x08
	MOVWF	SERiAL_DATA_COUNTER
SERiAL_DATA_3
	RLF	SERiAL_DATA,F
	BTFSS	STATUS,C
	GOTO	D3_0
	DATA_1			;DATA
	GOTO	D3_1
D3_1
	DATA_0			;DATA
D3_0
	CLOCK_1			;CLOCK
	CALL	TIMER_SERiAL
	CLOCK_0			;CLOCK
	DECFSZ	SERiAL_DATA_COUNTER,F
	GOTO	SERiAL_DATA_3
	LATC3_1
	CALL	TIMER_SERiAL
	LATC3_0
	RETURN
SERiAL_DATA_GONDER_4
	MOVLW	0x08
	MOVWF	SERiAL_DATA_COUNTER
SERiAL_DATA_4
	RLF	SERiAL_DATA,F
	BTFSS	STATUS,C
	GOTO	D4_0
	DATA_1			;DATA
	GOTO	D4_1
D4_1
	DATA_0			;DATA
D4_0
	CLOCK_1			;CLOCK
	CALL	TIMER_SERiAL
	CLOCK_0			;CLOCK
	DECFSZ	SERiAL_DATA_COUNTER,F
	GOTO	SERiAL_DATA_4
	LATC4_1
	CALL	TIMER_SERiAL
	LATC4_0
	RETURN

SERiAL_DATA_GONDER_5
	MOVLW	0x08
	MOVWF	SERiAL_DATA_COUNTER
SERiAL_DATA_5
	RLF	SERiAL_DATA,F
	BTFSS	STATUS,C
	GOTO	D5_0
	DATA_1			;DATA
	GOTO	D5_1
D5_1
	DATA_0			;DATA
D5_0
	CLOCK_1			;CLOCK
	CALL	TIMER_SERiAL
	CLOCK_0			;CLOCK
	DECFSZ	SERiAL_DATA_COUNTER,F
	GOTO	SERiAL_DATA_5
	LATC5_1
	CALL	TIMER_SERiAL
	LATC5_0
	RETURN
SIFIRLA_A
	MOVLW	0xFF
	MOVWF	SAYAC_A
	iNCF	SAYAC_A,F
	RETURN
SIFIRLA_B
	MOVLW	0xFF
	MOVWF	SAYAC_B
	iNCF	SAYAC_B,F
	RETURN
SIFIRLA_C
	MOVLW	0xFF
	MOVWF	SAYAC_C
	iNCF	SAYAC_C,F
	RETURN

TIMER_SERiAL
	MOVLW	0x05
	MOVWF	SAYAC1
NEXT_LOW_11
	DECFSZ	SAYAC1,F
	GOTO	NEXT_LOW
	RETURN

TiMER_KEYPAD
	MOVLW	0xFF
	MOVWF	NEXTA1
NEXT1_KEYPAD
	MOVLW	0xFF
	MOVWF	NEXTA2
NEXT2_KEYPAD
	DECFSZ	NEXTA2,F
	GOTO	NEXT2_KEYPAD
	DECFSZ	NEXTA1,F
	GOTO	NEXT1_KEYPAD
	RETURN

;*********************************
;*******PROGRAM BITIS KISMI*******
;*********************************
	END